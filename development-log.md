# 開発ログ

## 2025-07-19 プロジェクト初期設定完了

### 概要
複数のAWSアカウントのコスト削減取り組みの効果測定と削減優先度検討のための可視化ツールプロジェクトの初期設定を完了。

### 実施内容

#### 1. 要件定義・相談フェーズ
- **背景**: ユーザーは複数のAWSアカウントを持ち、コスト削減の取り組み効果を可視化したい
- **データ**: AWS コスト情報をCSV形式でダウンロード済み（月別・サービス別利用金額）
- **目的**: コスト削減効果の測定、削減優先度の検討

#### 2. 技術スタック決定
**相談過程**: 
- 動的データ取得は不要、取得済みCSVの読み込みのみ
- リッチなフレームワークは不要との方針確認

**決定した技術構成**:
- HTML5 + Vanilla JavaScript + Chart.js + CSS3
- 静的サイトとして構築（軽量・シンプル）

#### 3. 機能要件策定
**高優先度機能**:
1. 月次コスト推移（アカウント別/全体合計）
2. サービス別コスト比較  
3. 前月比増減率表示
4. サービス別コスト構成比（円グラフ）

**中優先度機能**:
1. 未使用/低使用サービス特定
2. アカウント別削減効果比較
3. 期間指定比較

**除外した機能**:
- 異常値・トレンド分析（ユーザー要望により除外）
- 削減目標設定（低優先度として後回し）

#### 4. データ構造・ファイル配置設計
```
resources/
├── dev/costs.csv      # 開発環境（元: resources/2025.csv）
├── prod/costs.csv     # 本番環境
└── staging/costs.csv  # ステージング環境
```
- `{env-name}` 部分をアカウント名として識別
- 各CSVは同じ基本形式だが、利用サービスに応じて列の増減あり

#### 5. ドキュメント作成
- **requirements.md**: 詳細な機能要件、優先度、技術要件
- **CLAUDE.md**: 将来のClaude Codeインスタンス向けプロジェクトガイド
  - 技術スタック説明
  - プロジェクト構造
  - 開発ワークフロー
  - データ構造仕様

#### 6. Git管理
- ファイル構造整理（2025.csv → resources/dev/costs.csv）
- 初回コミット: プロジェクトドキュメントと開発構造
- リモートリポジトリへpush完了

### 次のステップ
実装フェーズ開始 - 高優先度機能から順次実装予定

### 技術的決定事項
- フレームワーク不使用（Vanilla JS採用）
- Chart.jsによるグラフ描画
- File APIまたはHTTPによるCSV読み込み
- 静的サイトホスティング対応

## 2025-07-19 Git管理ルール策定

### 概要
プロジェクトのGit管理における適切なコミット単位とワークフローのルールを策定・ドキュメント化。

### 実施内容

#### 1. 現在の変更確認・コミット作業
- `development-log.md` の新規追加をコミット
- プロジェクト追跡用の開発ログとして位置付け

#### 2. Gitコミットルール策定
**コミット単位の基準**:
- 機能単位での論理的まとまり
- 関連するHTML/CSS/JS変更は同一コミット
- ドキュメント更新は機能と連動または独立コミット

**コミットメッセージ形式**:
```
動詞 + 対象 + 簡潔な説明

🤖 Generated with [Claude Code](https://claude.ai/code)
Co-Authored-By: Claude <noreply@anthropic.com>
```

#### 3. ドキュメント更新
- CLAUDE.mdに「Git コミットルール」セクション追加
- 開発者向けガイドライン整備
- 今後の継続開発での一貫性確保

#### 4. SSH接続確認
- GitHub SSH接続テスト実施（正常動作確認）
- `bwsunkist` アカウントでの認証成功

### 作成・更新ファイル
- `development-log.md` (新規作成・初期内容)
- `CLAUDE.md` (Gitルール追加)

### Git操作履歴
```
f34163e Add development log for project setup tracking
72b4a97 Add Git commit rules and workflow guidelines
```

### 今後の開発ログ運用
- 主要な開発活動・決定事項を継続記録
- コミット単位での作業内容記録
- 技術的決定の背景・理由の保存

## 2025-07-19 テスト環境構築

### 概要
Jest + JSDOMベースの包括的テスト環境を構築。複数アカウント対応とテスト駆動開発ワークフローを確立。

### 実施内容

#### 1. テスト環境設計・構築
**技術選択**:
- **Jest** - メインテストフレームワーク
- **JSDOM** - ブラウザ環境シミュレート
- **複数アカウント対応** - 実運用に近いテストデータ

**ディレクトリ構造**:
```
tests/
├── unit/               # 単体テスト（CSV解析、Chart設定等）
├── integration/        # 統合テスト（データフロー全体）
├── fixtures/           # テストデータ
│   ├── multi-account/  # dev/prod/staging環境データ
│   ├── edge-cases/     # 空データ、異常データ、異なるサービス
│   └── expected-results/ # 期待される処理結果
└── setup.js           # Jest設定・Mock
```

#### 2. テストデータ作成
**複数アカウントデータ**:
- **dev**: Lambda・CloudWatch中心（軽量）
- **prod**: EC2・RDS含む本格運用データ（重量）
- **staging**: 中規模データ

**エッジケース**:
- 空データアカウント
- 異なるサービス構成
- 異常データ（不正値・欠損）

#### 3. Jest設定・Mock環境
- Chart.js API Mock
- File API Mock（CSV読み込み）
- Fetch API Mock
- テストタイムアウト・ワーカー最適化

#### 4. テスト戦略ルール策定
**ワークフロー**:
- 機能実装と並行テスト作成
- 1機能完了毎の関連テスト実装
- 機能完了毎の回帰テスト実行
- 全テストパス後のみコミット許可

### 作成・更新ファイル
- `package.json` (Jest依存関係)
- `jest.config.js` (Jest設定)
- `tests/setup.js` (Mock環境)
- `tests/fixtures/**/*.csv` (テストデータ)
- `tests/expected-results/aggregated-data.json` (期待結果)
- `CLAUDE.md` (テスト戦略ルール追加)

### 技術的決定事項
- **Jest選択理由**: 設定簡単・豊富なMock・JSDOM統合
- **複数アカウント対応**: 実運用シナリオの網羅テスト
- **TDD採用**: 品質確保・回帰テスト自動化

### 次のステップ
実装フェーズ開始 - 各機能実装時にテスト駆動開発で進行

## 2025-07-19 アカウント登録機能実装・ユーザーマニュアル作成

### 概要
静的ファイル配置からアカウント登録ベースのファイルアップロード方式へ大幅変更。ユーザビリティを重視した柔軟なデータ取得方式を実装。

### 実施内容

#### 1. UI/UX大幅刷新
**アカウント登録フォーム**:
- アカウント名手動入力フィールド
- CSVファイル選択機能
- 登録状態のリアルタイム表示

**登録済みアカウント管理**:
- アカウント一覧表示（名前・ファイル情報）
- 個別削除・全削除機能
- データ分析開始ボタン

#### 2. CSS設計の全面的見直し
**新規スタイル**:
- 登録フォームの直感的デザイン
- アカウント一覧カードレイアウト
- アクションボタンの視覚的フィードバック
- レスポンシブ対応の強化

#### 3. CSV Parser完全実装
**機能**:
- File API対応の非同期読み込み
- 複数アカウントデータ集約
- エラーハンドリング・データ正規化
- 成長率計算・トレンド分析

#### 4. テスト環境の充実
**包括的テストデータ**:
- 複数アカウント用テストフィクスチャ
- エッジケース（空データ・異常データ）
- 期待結果データセット
- Jest + JSDOM環境構築

#### 5. ドキュメント体系の整備
**要件変更対応**:
- requirements.md: アップロードベース方式への更新
- CLAUDE.md: 新ワークフロー記載
- task-progress.md: 進捗管理・変更履歴

**ユーザー向けドキュメント**:
- USER_MANUAL.md: 操作手順・トラブルシューティング
- 実装済み/予定機能の明確な区別
- CSVファイル形式・要件の詳細説明

### 技術的決定事項
- **File API採用**: ローカルファイル直接読み込み
- **sessionStorage**: ブラウザ内データ永続化
- **段階的実装**: Phase 1完了→Phase 2可視化へ
- **柔軟性重視**: 固定アカウント名→任意設定可能

### 作成・更新ファイル
- `index.html` (UI大幅刷新)
- `css/style.css` (登録機能スタイル)
- `js/csv-parser.js` (完全実装)
- `tests/**/*` (包括的テスト環境)
- `USER_MANUAL.md` (新規作成)
- `.gitignore` (依存関係管理)
- `package.json`, `jest.config.js` (テスト環境)

### Git操作履歴
```
6f8dcda Implement account registration workflow and comprehensive test setup
```

### 現在の実装状況
**Phase 1**: 10/16完了 (62.5%) → **基盤構築ほぼ完了**
- ✅ HTML/CSS基盤
- ✅ アカウント管理機能
- ✅ CSV解析・データ処理
- 🔄 Chart.js設定（残り）

### 次のステップ
Phase 1.4: Chart.js基本設定 → Phase 2: データ可視化機能実装